\documentclass[10pt]{article}

% Lines beginning with the percent sign are comments
% This file has been commented to help you understand more about LaTeX

% DO NOT EDIT THE LINES BETWEEN THE TWO LONG HORIZONTAL LINES

%---------------------------------------------------------------------------------------------------------

% Packages add extra functionality.
\usepackage{times,graphicx,epstopdf,fancyhdr,amsfonts,amsthm,amsmath,algorithm,algorithmic,xspace,hyperref}
\usepackage[left=1in,top=1in,right=1in,bottom=1in]{geometry}
\usepackage{sect sty}	%For centering section headings
\usepackage{enumerate}	%Allows more labeling options for enumerate environments 
\usepackage{epsfig}
\usepackage[space]{grffile}
\usepackage{booktabs}
\usepackage{forest}
\usepackage{enumitem}   
\usepackage{fancyvrb}
\usepackage{todonotes}

% This will set LaTeX to look for figures in the same directory as the .tex file
\graphicspath{.} % The dot means current directory.

\pagestyle{fancy}

\lhead{Final Project}
\rhead{\today}
\lfoot{CSCI 334: Principles of Programming Languages}
\cfoot{\thepage}
\rfoot{Spring 2024}

% Some commands for changing header and footer format
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\headwidth}{\textwidth}
\renewcommand{\footrulewidth}{0.4pt}

% These let you use common environments
\newtheorem{claim}{Claim}
\newtheorem{definition}{Definition}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\newtheorem{observation}{Observation}
\newtheorem{question}{Question}

\setlength{\parindent}{0cm}

%---------------------------------------------------------------------------------------------------------

% DON'T CHANGE ANYTHING ABOVE HERE

% Edit below as instructed

\usepackage{array}

\title{CAT Language Specification} % Replace SnappyLanguageName with your project's name

\author{Michael Faulkner}

\begin{document}
  
\maketitle

\subsection*{Introduction}

CAT (Calculus and Algebra Tutor) is a domain-specific language designed to assist 
individuals with mathematical calculations. More specifically, the language allows 
users to input mathematical expressions and operations to perform on the expressions. 
Running a program in this language will then produce a textual represenation of the 
ensuing calculation as well as a \LaTeX{} file that can be compiled into a PDF that 
displays the calculation in a pretty manner.

\bigskip
While there exist computational tools for generalized mathematical expressions 
(for example Mathematica), such tools tend to focus only on getting to an answer. 
The purpose of CAT is to assist its users in understanding \textit{how} to get 
the answer by outputting the intermediate steps of the calculation. This 
addresses another point of annoyance with tools like Mathematica that will 
sometimes output, seemingly arbitrary, restrictions on the parameters alongside 
its final expression. By working through the intermediate steps of the calculation, 
CAT should allow its users to understand why such restrictions were imposed and 
what the limits of the calculation would be if such assumptions were not made.

\subsection*{Design Principles}

The primary goal of CAT is to produce easily understandable calculations. 
This goal corresponds with a prioritization of simpler techniques that are
easier to follow over more powerful techniques that might be able to find
more general answers but are less decipherable. This likely also means a
tradeoff in terms of speed as it is necessary to work through the intermediate
details of a calculation sufficiently to make them human readable.

\subsection*{Examples}
Turns out teaching a computer math is hard... these tweaked examples reflect
a shift in priorities I had. Basic symbolic manipulation of algebraic expressions
has turned out to be a mucher rich (and way more challenging!) task than I initially
thought it would be. Instead of calculus manipulations being a primary focus, I view
them more as stretch goals (maybe I can do derivatives, but I don't think integrals
are feasible), and I'm now primarily concerned with making the language
display how you could manipulate an algebraic expression. CAT is capable of most core 
algebraic (as the below examples demonstrate); however, there are essentially
limitless other simplification capabilities that could be added (see the 3rd example
for a current limitation of CAT), so I am more concerned with making CAT produce nice
output for its current capabilities than making CAT fully general.

\begin{enumerate}
    \item The following example illustrates how each line of a CAT program is
    treated separately so long as there are no assignments. The first line would
    simplify to $-1$, and the second line would simplify to $2x$ (derivatives
    are not currently implemented; however, this example demonstrates how
    they would work). \\
    \texttt{(x+1)(x-1) - x\^{}2 \\ Differentiate x\^{}2 + y\^{}2 wrt x}

    Sample output: \\
    \texttt{Expanding: (x + 1)(x + (-1)1) + (-1)(x\^{}2) \\
        ==> (1 + x)(x + (-1)1) + (-1)(x\^{}2) \\
        ==> (-1)(1)1 + (-1)1x + 1x + xx + (-1)(x\^{}2) \\
        Simplifying: (-1)(1)1 + (-1)1x + 1x + xx + (-1)(x\^{}2) \\
        ==> (-1)(1)1 + (-1)1x + 1x + xx + (-1)(x\^{}2) \\
        ==> -1 + (-1)1x + 1x + xx + (-1)(x\^{}2) \\
        ==> -1 + (-1)x + 1x + xx + (-1)(x\^{}2) \\
        ==> -1 + x + (-1)x + xx + (-1)(x\^{}2) \\
        ==> -1 + x + (-1)x + (-1)(x\^{}2) + x\^{}2 \\
        ==> -1 + 0 + 0 \\
        ==> -1 + 0 \\
        ==> -1
    } 

    \bigskip
    \texttt{Differentiating with respect to x: x\^{}2 + y\^{}2 \\
        ==> 0 + 2x \\
        Expanding: 0 + 2x \\
        ==> 0 + 2x \\
        Simplifying: 0 + 2x \\
        ==> 0 + 2x \\
        ==> 2x
    }

    \item The following example illustrates how CAT can recognize the same expression
    in different forms and simplify them to a point where they can be combined. This
    also demonstrates CAT's robustness to unusual styles regarding whitespace and use of 
    various symbols.
    This example should simplify to $0$. \\
    \texttt{1+ (x+y) ( x - y )---(x) x + y\^{} ( 2 ) - z\^{}((x+1)(x-1) - x\^{}2 + y\^{}(9 - 3\^{}2))}  
    
    The above calculation is quite tedious when every single step is written out, 
    but I include it here to demonstrate the flexiblity of CAT. The initial expression
    (if you look past all the intentional garballing I introduced to challenge CAT) is:
    $$1+(x+y)(x-y) - - - xx + y^{2} - z^{(x+1)(x-1) - x^2 + y^{9 - 3^2}}$$

    The \LaTeX{} output produced by running CAT on the above expression is included here verbatim:
\end{enumerate}

Simplifying: $1 + (x + y)(x + (-1)y) + (-1)((-1)((-1)(xx))) + y^{2} + (-1)(z^{(x + 1)(x + (-1)1) + (-1)(x^{2}) + y^{9 + (-1)(3^{2})}})$
$$1 + (-1)(-1)(-1)xx + (x + y)(x + (-1)y) + (-1)(z^{(1 + x)(x + (-1)1) + (-1)(x^{2}) + y^{9 + (-1)(3^{2})}}) + y^{2}$$
$$1 + (-1)(-1)(-1)xx + xx + (-1)xy + (-1)yy + xy + (-1)(z^{(1 + x)(x + (-1)1) + (-1)(x^{2}) + y^{9 + (-1)(3^{2})}}) + y^{2}$$
$$1 + (-1)(-1)(-1)xx + xx + (-1)xy + (-1)yy + xy + (-1)(z^{(-1)(1)1 + (-1)1x + 1x + xx + (-1)(x^{2}) + y^{9 + (-1)(3^{2})}}) + y^{2}$$
$$1 + (-1)(-1)(-1)xx + xx + (-1)xy + (-1)yy + xy + (-1)(z^{(-1)(1)1 + (-1)1x + 1x + xx + (-1)(x^{2}) + (y^{9})(y^{(-1)(3^{2})})}) + y^{2}$$
$$1 + (-1)(-1)(-1)xx + xx + (-1)xy + (-1)yy + xy + (-1)(z^{(-1)(1)1})(z^{(-1)1x})(z^{1x})(z^{xx})(z^{(-1)(x^{2})})(z^{(y^{9})(y^{(-1)(3^{2})})}) + y^{2}$$
$$1 + (-1)(-1)(-1)xx + xx + (-1)xy + (-1)yy + xy + (-1)(z^{(-1)(1)1})(z^{(-1)1x})(z^{1x})(z^{xx})(z^{(-1)(x^{2})})(z^{(y^{9})(y^{(-1)(3^{2})})}) + y^{2}$$
$$1 + xx + (-1)xy + (-1)yy + xy + (-1)(x^{2}) + (-1)(z^{(-1)(1)1})(z^{(-1)1x})(z^{1x})(z^{xx})(z^{(-1)(x^{2})})(z^{(y^{9})(y^{(-1)(3^{2})})}) + y^{2}$$
$$1 + (-1)xy + (-1)yy + xy + (-1)(x^{2}) + (-1)(z^{(-1)(1)1})(z^{(-1)1x})(z^{1x})(z^{xx})(z^{(-1)(x^{2})})(z^{(y^{9})(y^{(-1)(3^{2})})}) + x^{2} + y^{2}$$
$$1 + (-1)xy + xy + (-1)(x^{2}) + (-1)(y^{2}) + (-1)(z^{(-1)(1)1})(z^{(-1)1x})(z^{1x})(z^{xx})(z^{(-1)(x^{2})})(z^{(y^{9})(y^{(-1)(3^{2})})}) + x^{2} + y^{2}$$
$$1 + (-1)xy + xy + (-1)(x^{2}) + (-1)(y^{2}) + (-1)(z^{-1})(z^{(-1)1x})(z^{1x})(z^{xx})(z^{(-1)(x^{2})})(z^{(y^{9})(y^{(-1)(3^{2})})}) + x^{2} + y^{2}$$
$$1 + (-1)xy + xy + (-1)(x^{2}) + (-1)(y^{2}) + (-1)(z^{-1})(z^{(-1)x})(z^{1x})(z^{xx})(z^{(-1)(x^{2})})(z^{(y^{9})(y^{(-1)(3^{2})})}) + x^{2} + y^{2}$$
$$1 + (-1)xy + xy + (-1)(x^{2}) + (-1)(y^{2}) + (-1)(z^{-1})(z^{x})(z^{(-1)x})(z^{xx})(z^{(-1)(x^{2})})(z^{(y^{9})(y^{(-1)(3^{2})})}) + x^{2} + y^{2}$$
$$1 + (-1)xy + xy + (-1)(x^{2}) + (-1)(y^{2}) + (-1)(z^{-1})(z^{x})(z^{(-1)x})(z^{(-1)(x^{2})})(z^{(y^{9})(y^{(-1)(3^{2})})})(z^{x^{2}}) + x^{2} + y^{2}$$
$$1 + (-1)xy + xy + (-1)(x^{2}) + (-1)(y^{2}) + (-1)(z^{-1})(z^{x})(z^{(-1)x})(z^{(-1)(x^{2})})(z^{(y^{9})(y^{(-1)9})})(z^{x^{2}}) + x^{2} + y^{2}$$
$$1 + (-1)xy + xy + (-1)(x^{2}) + (-1)(y^{2}) + (-1)(z^{-1})(z^{x})(z^{(-1)x})(z^{(-1)(x^{2})})(z^{(y^{-9})(y^{9})})(z^{x^{2}}) + x^{2} + y^{2}$$
$$1 + (-1)xy + xy + (-1)(x^{2}) + (-1)(y^{2}) + (-1)(z^{-1})(z^{x})(z^{(-1)x})(z^{(-1)(x^{2})})(z^{x^{2}})(z^{y^{-9 + 9}}) + x^{2} + y^{2}$$
$$1 + (-1)xy + xy + (-1)(x^{2}) + (-1)(y^{2}) + (-1)(z^{-1})(z^{x})(z^{(-1)x})(z^{(-1)(x^{2})})(z^{x^{2}})(z^{y^{0}}) + x^{2} + y^{2}$$
$$1 + (-1)xy + xy + (-1)(x^{2}) + (-1)(y^{2}) + (-1)(z^{-1})(z^{1})(z^{x})(z^{(-1)x})(z^{(-1)(x^{2})})(z^{x^{2}}) + x^{2} + y^{2}$$
$$1 + (-1)xy + xy + (-1)(x^{2}) + (-1)(y^{2}) + (-1)(z^{-1 + 1 + x + (-1)x + (-1)(x^{2}) + x^{2}}) + x^{2} + y^{2}$$
$$1 + (-1)xy + xy + (-1)(x^{2}) + (-1)(y^{2}) + (-1)(z^{-1 + 0 + 0 + 1}) + x^{2} + y^{2}$$
$$1 + (-1)xy + xy + (-1)(x^{2}) + (-1)(y^{2}) + (-1)(z^{-1 + 0 + 1}) + x^{2} + y^{2}$$
$$1 + (-1)xy + xy + (-1)(x^{2}) + (-1)(y^{2}) + (-1)(z^{0}) + x^{2} + y^{2}$$
$$1 + (-1)1 + (-1)xy + xy + (-1)(x^{2}) + (-1)(y^{2}) + x^{2} + y^{2}$$
$$-1 + 1 + (-1)xy + xy + (-1)(x^{2}) + (-1)(y^{2}) + x^{2} + y^{2}$$
$$-1 + 0 + 0 + 0 + 1$$
$$-1 + 0 + 1$$
$$0$$

\begin{enumerate}
    \setcounter{enumi}{2}
    \item This last example highlights CAT's current ability to factor expressions.
    CAT automatically expands expressions before simplifying them, so this example
    demonstrates how sometimes CAT will not recover the original expression. In a
    perfect world, this expression would simplify to \texttt{(x + y + z)\^{}2}. \\
    \texttt{(x + y + z)(x + y + z)}

    Sample output: \\
    \texttt{Expanding: (x + y + z)(x + y + z) \\
        ==> (x + y + z)(x + y + z) \\
        ==> xx + xy + xy + yy + xz + xz + yz + yz + zz \\
        Simplifying: xx + xy + xy + yy + xz + xz + yz + yz + zz \\
        ==> xx + xy + xy + yy + xz + xz + yz + yz + zz \\
        ==> xy + xy + yy + xz + xz + yz + yz + zz + x\^{}2 \\
        ==> xy + xy + xz + xz + yz + yz + zz + x\^{}2 + y\^{}2 \\
        ==> xy + xy + xz + xz + yz + yz + x\^{}2 + y\^{}2 + z\^{}2 \\
        ==> 2xy + 2xz + 2yz + x\^{}2 + y\^{}2 + z\^{}2 \\
        ==> 2(xy + xz + yz) + x\^{}2 + y\^{}2 + z\^{}2 \\
        ==> 2(yz + x(y + z)) + x\^{}2 + y\^{}2 + z\^{}2
    } 
\end{enumerate}

\subsection*{Language Concepts}

At it's core, CAT is a way of expressing and manipulating mathematical expressions. 
Each line of a CAT program constitutes an expression that will be evaluated. Evaluating
an expression involves reducing it to the simplist form possible by applying operators
and performing algebraic manipulations. The primitives of CAT are variables (i.e. $x, y, z$) 
and numbers (i.e. $1, -10, 3.141592$). These primitives can be combined with mathematical
operations such as +, -, *, /, \^{}, (and maybe Differentiate) in order to form expressions. 

\subsection*{Formal Syntax}

\begin{tabular}{>{\texttt\bgroup}l<{\egroup} >{\texttt\bgroup}r<{\egroup} >{\texttt\bgroup}l<{\egroup}}
    <instruction> &::=& <expr> (`\textbackslash{}n' <expr>)\textsuperscript{*}\\
    <expr> &::=& <ws>\textsuperscript{*}<operation><ws>\textsuperscript{*} \\
    &|& <ws>\textsuperscript{*}<parens><ws>\textsuperscript{*} \\
    &|& <ws>\textsuperscript{*}<literal><ws>\textsuperscript{*} \\
    <operation> &::=& <expr><op><expr> \\
    &|& <expr><ws>\textsuperscript{+}<expr> \\
    &|& <expr><parens> \\
    &|& <parens><expr> \\
    <op> &::=& + | - | * | / | \^{} \\
    <parens> &::=& (<expr>) \\
    <literal> &::=& <number> \\
    &|& <variable> \\
    <number> &::=& <digits> \\
    &|& -<digits> \\
    &|& <digits>.<digits> \\
    &|& -<digits>.<digits> \\
    &|& .<digits> \\
    &|& -.<digits> \\
    &|& <digits>. \\
    &|& -<digits>. \\
    <digits> &::=& <d><digits> \\
    &|& <d> \\
    <d> &::=& 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 \\
    <variable> &::=& a | b | c |\dots| x | y | z \\
    <ws> &::=& Any non-newline whitespace character.
\end{tabular}

\subsection*{Semantics}

\begin{tabular}{>{\centering}p{.27 \textwidth}|>{\centering}p{.1 \textwidth}|>{\centering}p{.1 \textwidth}|p{.4 \textwidth}}
    \textbf{Syntax} & \textbf{Abstract Syntax} & \textbf{Prec/Assoc} & \centering \textbf{Meaning} \tabularnewline
    \hline
    \texttt{<number>} & Number of double & N/A & \texttt{number} is a primitive. 
    I represent numbers using the F\# double datatype. \\
    \hline
    \texttt{<variable>} & Variable of char & N/A & \texttt{variable} is a primitive. 
    I represent variables using the F\# char datatype. These represent symbolic
    variables that are used in mathematical expressions. \\
    \hline
    \texttt{<expr> (`\textbackslash{}n' <expr>)\textsuperscript{*}} & Sequence of Expression list & 0 / left &
    \texttt{Sequence} consists of a list of expressions to be simplified. Every CAT program has one \texttt{Sequence}
    which consists of each line of the program. After evaluating, each expression within a \texttt{Sequence} is converted
    into a list of expressions that represent progressive simplifications of the original expression.
\end{tabular}

% \begin{enumerate}[label= (\roman*)]
%     \item The primitives in CAT are numbers and variables (i.e. $1.234$ or $x$)
%     \item CAT supports many combining forms. These combining forms correspond with
%     mathematical operations that take two or more operations. These include: +, -, 
%     *, /, \^{}, Differentiate, and Integrate. Additionally, each line of a CAT program
%     corresponds to a separate expression that will be evaluated in sequence. Thus,
%     a newline can be understood as a sequence operator. Assignments are also combining
%     forms that bind a variable to some other expression. These are the only kinds of
%     statements that interact with future lines (i.e. the line $z = x + y$ would affect
%     all future uses of the variable $z$ in subsequent lines).
%     \item 
%         \begin{enumerate}[label= (\Alph*)]
%             \item CAT programs are executed by passing them to the interpreter within
%             a text file. For example, if I wanted to run the program \texttt{math.cat},
%             I would run \texttt{dotnet run math.cat}.
%             \item Evaluating a CAT program will result in two outputs representing the
%             same calculation. For each line in a CAT program, the language will attempt
%             to simplify the mathematical expression as much as it can. This simplification
%             occurs in a sequence of steps. Each step will be printed as a textual output.
%             Additionally, a \LaTeX{} file will be produced (and hopefully automatically
%             compiled into a pdf) representing the same calculation but in an easier to
%             read form.

%             For example, the program: 
%             \texttt{(x+1)(x-1) - x\^{}2 \\ Differentiate x\^{}2 + y\^{}2 wrt x} \\
%             would produce the output: \\
%             \texttt{Expanding: (x + 1)(x + (-1)1) + (-1)(x\^{}2) \\
%             ==> (1 + x)(x + (-1)1) + (-1)(x\^{}2) \\
%             ==> (-1)(1)1 + (-1)1x + 1x + xx + (-1)(x\^{}2) \\
%             Simplifying: (-1)(1)1 + (-1)1x + 1x + xx + (-1)(x\^{}2) \\
%             ==> (-1)(1)1 + (-1)1x + 1x + xx + (-1)(x\^{}2) \\
%             ==> -1 + (-1)1x + 1x + xx + (-1)(x\^{}2) \\
%             ==> -1 + (-1)x + 1x + xx + (-1)(x\^{}2) \\
%             ==> -1 + x + (-1)x + xx + (-1)(x\^{}2) \\
%             ==> -1 + x + (-1)x + (-1)(x\^{}2) + x\^{}2 \\
%             ==> -1 + 0 \\
%             ==> -1
%             }

%             Note: the above output is what the language currently produces. One of my goals
%             over the next week is to get the language to have slightly prettier formatting
%             and what I subjectively consider a more human-like arrangement of terms.

%             \bigskip
%             The below represents hypothetical output assuming I get to implementing differentiation.
            
%             \texttt{Simplifying: Differentiate x\^{}2 + y\^{}2 wrt x \\
%                 ==> 2x + 0 \\
%                 ==> 2x
%             }
%         \end{enumerate}
% \end{enumerate}

% DO NOT DELETE ANYTHING BELOW THIS LINE
\end{document}
